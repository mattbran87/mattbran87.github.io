# Notes: Series Support

## Research & Planning

### Findings

#### Approach Evaluation

Three approaches were evaluated:

1. **Pure Liquid + `_data/series.yml`** — CHOSEN
   - Posts declare `series` (slug) and `series_part` (integer) in front matter
   - Centralized `_data/series.yml` stores series metadata (title, description, status)
   - Liquid templates handle filtering (`where`), sorting (`sort`), and rendering
   - Zero plugin dependencies, full control, works with existing infrastructure

2. **Plugin-based (jekyll-series, jekyll-group)** — REJECTED
   - `jekyll-series` v1.0.3 last updated 2017, ~6,675 downloads, outdated dependencies
   - `jekyll-group` v0.1 last updated 2021, ~2,645 downloads
   - Both effectively abandoned; not worth the dependency for what Liquid can handle

3. **Jekyll Collections** — REJECTED
   - Would require each series as a separate collection in `_config.yml`
   - Series posts lose access to `site.posts`, tags, `jekyll-archives`, feeds
   - Cannot mix series posts with standalone posts in a unified blog feed
   - Architectural mismatch — collections are for fundamentally different content types

#### Key Technical Details

- **Liquid `where` filter** scans all `site.posts` per render — negligible for <500 posts
- **`group_by` filter** changed behavior in Jekyll 4.1+ — need to test with 4.4.1
- **No native "find by index"** in Liquid — prev/next requires `forloop.index` iteration
- **No automatic page generation from data** — series archive pages must be created manually (one `.html` file per series)
- **Permalink system** has no `:series` placeholder — archive pages need explicit `permalink` front matter
- **Existing prev/next nav** in `post.html` is chronological — series nav is a separate concept

#### Patterns from Existing Codebase

- Tags implementation (`_includes/post-tags.html`) is the model: guard nil/empty, slugify, ARIA labels
- SCSS partials follow BEM naming, use CSS custom properties from `_variables.scss`
- New styles go in `assets/css/_partials/_series.scss`, imported in `assets/main.scss`
- Code guidelines require Liquid comments on control flow, semantic HTML, 4-space indentation

#### Inspiration from Other Generators

- **Hugo**: Built-in `series` taxonomy, `series_weight` for ordering, automatic index pages
- **Eleventy**: Data cascade with `_data/seriesData.json`, `aria-current="page"` on TOC items

### Open Questions

- [x] Should series use a dedicated collection or just front matter on regular posts? → **Front matter** (Decision D1)
- [x] Should series archive pages be generated by a plugin or hand-built with Liquid? → **Manual per-series pages** (Decision D2)
- [x] What front matter fields are needed? → `series` (slug) + `series_part` (integer) (Decision D3)
- [x] Where should the series TOC appear on a post — sidebar, above content, or below title? → **Below title/meta, always visible** (Decision D4)
- [x] Should series navigation (prev/next) be separate from the existing post nav, or replace it? → **Coexist — both shown** (Decision D5)
- [x] How should series URLs be structured? → `/series/slug/` via manual pages (Decision D2)

### References

- [Create a blog post series with navigation in Jekyll — Opensource.com](https://opensource.com/article/22/4/blog-series-navigation-jekyll)
- [Create a series of posts with navigation in Jekyll — Ayush Sharma](https://www.ayush.nz/2022/02/creating-article-series-posts-navigation-jekyll)
- [Jekyll Data Files documentation](https://jekyllrb.com/docs/datafiles/)
- [Hugo Taxonomies documentation](https://gohugo.io/content-management/taxonomies/)
- [How to build a blog series with Eleventy — Jamie Cecile Smith](https://jamiececilesmith.com/building-a-series-with-eleventy/)

---

## Implementation

- **Gotcha: `pluralize` filter does not exist in Jekyll.** Used it in series index and archive layouts — it silently outputs the input value rather than erroring. Fixed with a Liquid `{% if size == 1 %}part{% else %}parts{% endif %}` conditional.
- **Prev/next by part number** — Liquid lacks array index lookup, so prev/next is found by iterating `series_posts` and comparing `series_part` to `page.series_part +/- 1`. Works correctly.
- **`aria-current="page"`** borrowed from Eleventy pattern — used on the current post in the series TOC for screen reader accessibility.
- **Series TOC uses CSS counters** instead of `<ol>` default numbering for consistent styling with the BEM approach.
- 11 commits on the feature branch, one per logical task plus the pluralize fix.

---

## Testing

- **AC1–AC6, AC8–AC10: All passed on first test run.**
- **AC7 (Accessibility): Failed initially — 3 issues found:**
  1. Missing `focus-visible` styles on `.series-toc__item a` and `.series-toc__nav-link` (WCAG 2.4.7)
  2. Status badge contrast borderline — darkened text colors for safety (WCAG 1.4.3)
  3. Series index page lacked `<section>` wrapper for screen reader context (WCAG 1.3.1)
- All 3 issues fixed in a single commit, retested — AC7 now passes.
- **Edge cases verified:** Part 1 has no prev link, Part 3 has no next link, non-series post has no series components.

---

## Acceptance

- All 8 requirements verified as implemented
- All 10 acceptance criteria confirmed as met
- All 6 constraints verified: pure Liquid (no plugins), BEM + custom props, WCAG AA, part-number ordering, no URL changes, tags unaffected
- All 7 decisions (D1–D7) followed as recorded
- 22/22 tasks completed across all phases
